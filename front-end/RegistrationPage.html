<!DOCTYPE html>
<html>
 <body>
     <form id="login-form">
        <input type="text" id="user-name" placeholder="Login" required>
        <br><br>
        <input type="password" id="user-password" placeholder="Password" required>
        <br><br>
        <input type="password" id="confirm-password" placeholder="Confirm password" required><br><br>
        <button type="button" id="register">Register</button>
        <button type="button" id="login">Login</button>
     </form>

     <script>
         function applyBindings(){
             document.getElementById("register").addEventListener("click", function (){
                 get_user_data(true)
             })

             document.getElementById("login").addEventListener("click", function (){
                 get_user_data(false)
             })
         }

         applyBindings()

         function clear_form(){
            document.getElementById("user-name").value = "";
            document.getElementById("user-password").value = "";
            document.getElementById("confirm-password").value = "";
         }

         function get_user_data(register) {
            login = document.getElementById("user-name").value
            password = document.getElementById("user-password").value
            confirmPassword = document.getElementById("confirm-password").value

            // validate password
            if (password !== confirmPassword) {
                clear_form()
                alert("Password doesn't match")
            }

            var xhr = new XMLHttpRequest()
            var url

            if (register){
                url = "/login/register"
            }

            else{
                url = "/login"
            }
            
            xhr.open("POST", url, true)
            xhr.setRequestHeader("Content-Type", "application/json")
            var data = JSON.stringify({"login" : login, "password" : password})
            xhr.send(data)

            clear_form()
         }
     </script>
 </body>  
</html>